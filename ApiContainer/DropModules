declare @query nvarchar(max);

select @query = (
select ' union all
select ' +  + quotename(name,'''') + ' as database_name,
	s.name COLLATE DATABASE_DEFAULT as schema_name
from '+ quotename(name) + '.sys.schemas s
where s.name not in  (
	''dbo'',
	''db_accessadmin'',
	''db_backupoperator'',
	''db_datareader'',
	''db_datawriter'',
	''db_ddladmin'',
	''db_denydatareader'',
	''db_denydatawriter'',
	''db_owner'',
	''db_securityadmin'',
	''guest'',
	''INFORMATION_SCHEMA'',
	''sys''
)'
from sys.databases 
where state=0 and database_id > 4
order by [name] for xml path(''), type).value('.', 'nvarchar(max)');

set @query = stuff(@query, 1, 12, '') + ' order by database_name, schema_name';

create table #Temp (
	[database_name] nvarchar(50) NULL,
	[schema_name] nvarchar(50) NULL,
)

insert into #Temp
execute (@query)

select 'alter database [' + [database_name] + '] set single_user with rollback immediate; ' + ' drop database [' + [database_name] + '];'
from #Temp
group by [database_name]
having count([schema_name]) = 1

drop table #Temp
